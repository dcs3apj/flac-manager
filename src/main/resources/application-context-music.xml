<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:util="http://www.springframework.org/schema/util"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd"
	default-autowire="byName">

	<context:annotation-config/>
	
	<bean id="devicesDirectory" class="java.io.File">
		<constructor-arg value="/mnt/multimedia/devices"/>
	</bean> 
	
	<bean id="mp3Encoding" class="uk.co.unclealex.music.Encoding">
		<property name="extension" value="mp3"/>
	</bean>
	
	<bean id="oggEncoding" class="uk.co.unclealex.music.Encoding">
		<property name="extension" value="ogg"/>
	</bean>

	<util:set id="encodings" set-class="java.util.TreeSet" value-type="uk.co.unclealex.music.Encoding">
		<ref bean="mp3Encoding"/>
		<ref bean="oggEncoding"/>
	</util:set>
	
	<util:set id="allDevices" set-class="java.util.TreeSet" value-type="uk.co.unclealex.music.Device">
		<bean class="uk.co.unclealex.music.IpodDevice">
			<property name="name" value="ipod"/>
			<property name="encoding" ref="mp3Encoding"/>
			<property name="owner" value="alex"/>
			<!-- <property name="mountPoint" value="/home/alex/ipod"/> -->
			<property name="mountPoint" value="/media/IPOD"/>
		</bean>
		<bean class="uk.co.unclealex.music.MtpDevice">
			<property name="name" value="creative zen"/>
			<property name="encoding" ref="mp3Encoding"/>
			<property name="owner" value="alex"/>
		</bean>
		<bean class="uk.co.unclealex.music.FileSystemDevice">
			<property name="name" value="walkman"/>
			<property name="encoding" ref="mp3Encoding"/>
			<property name="owner" value="alex"/>
			<property name="mountPoint" value="/media/WALKMAN/MUSIC"/>
		</bean>
		<bean class="uk.co.unclealex.music.FileSystemDevice">
			<property name="name" value="iriver"/>
			<property name="encoding" ref="oggEncoding"/>
			<property name="owner" value="trevor"/>
			<property name="mountPoint" value="/media/disk"/>
		</bean>
	</util:set>

	<bean id="processService" class="uk.co.unclealex.music.ProcessServiceImpl"/>
	
	<bean id="flacDirectory" class="java.io.File">
		<constructor-arg value="/mnt/multimedia/flac"/>
	</bean>
	
	<bean id="latinService" class="uk.co.unclealex.music.LatinServiceImpl"/>
	
	<bean id="deviceService" class="uk.co.unclealex.music.DeviceServiceImpl"/>
	<bean id="fileService" class="uk.co.unclealex.music.FileServiceImpl"/>
	
	<bean id="synchroniserService" class="uk.co.unclealex.music.sync.SynchroniserServiceImpl"/>
	
	<bean id="synchroniserFactory" class="uk.co.unclealex.music.sync.SpringSynchroniserFactory">
		<property name="filesystemSynchroniserBeanName" value="fileSystemSynchroniser"/>
		<property name="ipodSynchroniserBeanName" value="ipodSynchroniser"/>
		<property name="mtpSynchroniserBeanName" value="mtpSynchroniser"/>
	</bean>
	
	<bean id="mtpSynchroniser" class="uk.co.unclealex.music.sync.MtpSynchroniser" scope="prototype"/>
	<bean id="ipodSynchroniser" class="uk.co.unclealex.music.sync.IpodSynchroniser" scope="prototype"/>
	<bean id="fileSystemSynchroniser" class="uk.co.unclealex.music.sync.FileSystemSynchroniser" scope="prototype"/>

	<bean id="jaudioTaggerArtworkManager" class="uk.co.unclealex.music.covers.JAudioTaggerArtworkManager"/>
	<alias alias="flacArtworkManager" name="jaudioTaggerArtworkManager"/>
	
	<bean id="mp3ArtworkManager" class="uk.co.unclealex.music.covers.Mp3JAudioTaggerArtworkManager"/>
	
	<bean id="artworkSearchingService" class="uk.co.unclealex.music.covers.AmazonArtworkSearchingService"/>
	
	<bean id="signedRequestsService" class="uk.co.unclealex.music.covers.SignedRequestsServiceImpl" init-method="initialise">
		<property name="awsAccessKeyId" value="1GK0A6KVNQEFVH5Q1Z82"/>
		<property name="awsSecretKey" value="jq/BOXh4dOYXsso3jn/N8FGF7/40YCPHmTyas1ZF"/>
		<property name="endpoint" value="ecs.amazonaws.co.uk"/>
	</bean>	

	<bean id="encodedDirectory" class="java.io.File">
		<constructor-arg value="/mnt/multimedia/encoded"/>
	</bean> 
		
	<util:map id="encodingArtworkManagers"
		key-type="uk.co.unclealex.music.encoding.Encoding"
		value-type="uk.co.unclealex.music.covers.ArtworkManager"
		map-class="java.util.TreeMap">
		<entry key-ref="mp3Encoding" value-ref="mp3ArtworkManager"/>
	</util:map>
	
	<bean id="artworkUpdatingService" class="uk.co.unclealex.music.encoding.ArtworkUpdatingServiceImpl"/>
	<bean id="encodingService" class="uk.co.unclealex.music.encoding.EncodingServiceImpl">
		<property name="maximumThreads" value="4"/>
	</bean>
	<bean id="singleEncodingService" class="uk.co.unclealex.music.encoding.SingleEncodingServiceImpl"/>
	<bean id="importService" class="uk.co.unclealex.music.encoding.ImportServiceImpl"/>
	<bean id="imageService" class="uk.co.unclealex.music.encoding.ImageServiceImpl"/>
	<bean id="fileFixingService" class="uk.co.unclealex.music.encoding.FileFixingServiceImpl"/>
	<bean id="renamingService" class="uk.co.unclealex.music.encoding.RenamingServiceImpl"/>

</beans>
